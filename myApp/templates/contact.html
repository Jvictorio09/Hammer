{% extends "base.html" %}
{% load static %}

{% block title %}Contact | Hammer{% endblock %}

{% block content %}
{% include "partials/contact.html" %}


<!-- MAP (Light, matching contact) -->
<section id="map" class="relative overflow-hidden bg-[#F8FAFC] text-[#0B0E14]">
  <div class="pointer-events-none absolute inset-x-0 -top-40 h-80 bg-[radial-gradient(50%_50%_at_50%_0%,rgba(24,175,171,.12),transparent)]"></div>

  <div class="relative max-w-7xl mx-auto px-6 pt-10 pb-20">
    <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-6">
      <div>
        <p class="text-[11px] tracking-[.45em] uppercase text-[#18AFAB]">Find Us</p>
        <h3 class="mt-2 text-2xl md:text-3xl font-extrabold">Dubai, UAE</h3>
        <p class="mt-2 text-[#475569]">
          Hammer — Design & Build HQ<br>
          Dubai, United Arab Emirates
        </p>
      </div>
      <div class="flex items-center gap-3">
        <a href="https://www.google.com/maps/search/?api=1&query=Dubai%2C+UAE" target="_blank" rel="noopener"
           class="inline-flex items-center gap-2 rounded-full border border-black/10 px-4 py-2 text-sm hover:bg-black/[.03] transition">
          <i class="fa-solid fa-location-dot text-[#18AFAB]"></i> Open in Google Maps
        </a>
        <a href="tel:+971555555555"
           class="inline-flex items-center gap-2 rounded-full border border-black/10 px-4 py-2 text-sm hover:bg-black/[.03] transition">
          <i class="fa-solid fa-phone text-[#18AFAB]"></i> +971 55 555 5555
        </a>
      </div>
    </div>

    <div class="mt-6 relative rounded-2xl overflow-hidden shadow-[0_18px_40px_rgba(2,6,23,.08)] ring-1 ring-black/5 bg-white">
      <iframe
        title="Hammer – Dubai Map"
        width="100%" height="420" loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        style="border:0; display:block"
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14438.706907347632!2d55.2708!3d25.2048!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e5f434c2f2a0a65%3A0x9c33d6d0f4f0a0a8!2sDubai%2C%20UAE!5e0!3m2!1sen!2sAE!4v1680000000000">
      </iframe>
      <div class="pointer-events-none absolute left-4 top-4 rounded-full bg-white/85 text-[#0B0E14] text-xs px-3 py-1.5 backdrop-blur ring-1 ring-black/5">
        <span class="inline-flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-[#18AFAB]"></span> Dubai HQ
        </span>
      </div>
    </div>
  </div>
</section>

<style>
/* Float labels + input focus ring (light theme) */
.input-fx{
  width:100%;
  border-radius:.875rem;
  border:1px solid #E5E7EB;
  padding:.75rem 1rem .75rem 2.5rem;
  outline:none;
  transition: box-shadow .25s ease, border-color .25s ease, background-color .25s ease;
  background:#fff;
}
.input-fx:focus{
  border-color:#18AFAB;
  box-shadow:0 0 0 3px rgba(24,175,171,.18);
  background:#fff;
}
.float-label{
  position:absolute; left:2rem; top:-.5rem;
  background:#fff; padding:0 .4rem; border-radius:.35rem;
  font-size:11px; letter-spacing:.04em; color:#6B7280; transition: all .2s ease;
}
.peer::placeholder { color:transparent; }
.peer:placeholder-shown ~ .float-label{
  top:.75rem; left:2.5rem; background:transparent; font-size:.85rem;
}

/* Reveal animations */
.reveal-left, .reveal-right { opacity:0; transform: translateY(18px); }
.reveal-left.revealed, .reveal-right.revealed{
  opacity:1; transform:translateY(0); transition: all .8s cubic-bezier(.22,1,.36,1);
}
.reveal-right{ transform: translateY(18px) translateX(16px); }
.reveal-right.revealed{ transform:none; }

/* Button micro-movement */
#submitBtn:hover{ transform: translateY(-1px); }

/* WhatsApp FAB */
.whatsapp-fab{ box-shadow: 0 14px 30px -10px rgba(2,6,23,.20); }
</style>

<script>
/* Intersection reveal */
(function(){
  const nodes = document.querySelectorAll('#contact .reveal-left, #contact .reveal-right');
  if(!nodes.length) return;
  if(!('IntersectionObserver' in window)){
    nodes.forEach(n=>n.classList.add('revealed'));
    return;
  }
  const io = new IntersectionObserver((entries, obs)=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.style.transitionDelay = '80ms';
        e.target.classList.add('revealed');
        obs.unobserve(e.target);
      }
    });
  }, { threshold:.15 });
  nodes.forEach(n=>io.observe(n));
})();

/* AJAX submit to Django contact endpoint (progressive enhancement) */
(function(){
  const form  = document.getElementById('contactForm');
  const btn   = document.getElementById('submitBtn');
  const toast = document.getElementById('contactToast');
  if(!form) return;

  const getCSRF = () => {
    const el = form.querySelector('input[name=csrfmiddlewaretoken]');
    return el ? el.value : '';
  };

  form.addEventListener('submit', async function(e){
    e.preventDefault();

    btn.classList.add('is-loading');
    btn.setAttribute('disabled','disabled');

    try{
      const res = await fetch(form.action, {
        method: 'POST',
        headers: { 'X-CSRFToken': getCSRF() },
        body: new FormData(form),
      });

      if(!res.ok) throw new Error('Submit failed');

      form.reset();
      btn.classList.remove('is-loading');
      btn.removeAttribute('disabled');

      toast.classList.remove('hidden');
      toast.style.opacity = '0';
      toast.style.transform = 'translate(-50%, 10px)';
      requestAnimationFrame(()=>{
        toast.style.transition = 'all .4s ease';
        toast.style.opacity = '1';
        toast.style.transform = 'translate(-50%, 0)';
      });
      setTimeout(()=>{
        toast.style.opacity = '0';
        toast.style.transform = 'translate(-50%, 10px)';
        setTimeout(()=>toast.classList.add('hidden'), 350);
      }, 2800);

    } catch(err){
      btn.classList.remove('is-loading');
      btn.removeAttribute('disabled');
      form.submit();
    }
  });
})();
</script>
{% endblock %}
