{% extends "base.html" %}
{% load static %}

{% block title %}Contact | Hammer{% endblock %}

{% block content %}
<!-- CONTACT (Light, Polished, Django-ready) -->
<section id="contact" class="relative overflow-hidden bg-white text-[#0B0E14]">
  <!-- soft texture + hint of teal glow (very subtle on light) -->
  <div class="pointer-events-none absolute inset-0 opacity-[.03] bg-[url('https://www.transparenttextures.com/patterns/white-diamond.png')]"></div>
  <div class="pointer-events-none absolute inset-0 bg-[radial-gradient(80%_60%_at_20%_20%,rgba(24,175,171,.08),transparent_60%)]"></div>

  <div class="relative max-w-7xl mx-auto px-6 py-20 lg:py-28 grid lg:grid-cols-2 gap-16 items-center">
    <!-- Left: narrative + trust -->
    <div class="reveal-left">
      <p class="text-[11px] tracking-[.35em] uppercase text-[#18AFAB]">Start a Project</p>
      <h2 class="mt-2 text-3xl md:text-5xl font-extrabold leading-[1.1]">
        Ready to Transform<br class="hidden md:block"/> Your Space?
      </h2>
      <p class="mt-4 text-[#334155] max-w-xl">
        Let Hammer design the villa, interior, or landscape of your dreams—executed with
        <span class="text-[#18AFAB]">precision</span>, <span class="text-[#18AFAB]">discretion</span>, and unmatched craftsmanship.
        One integrated team. One contract. Zero friction.
      </p>

      <!-- trust list -->
      <ul class="mt-8 space-y-3 text-sm text-[#475569]">
        <li class="flex items-start gap-3">
          <i class="fa-regular fa-clock mt-0.5 text-[#18AFAB]"></i>
          <span>Human response within <b>24 hours</b> (Mon–Sat)</span>
        </li>
        <li class="flex items-start gap-3">
          <i class="fa-solid fa-shield-halved mt-0.5 text-[#18AFAB]"></i>
          <span>Your privacy is protected. Plans & details are treated confidentially.</span>
        </li>
        <li class="flex items-start gap-3">
          <i class="fa-solid fa-diagram-project mt-0.5 text-[#18AFAB]"></i>
          <span><b>No-obligation</b> consult: we map options, budget bands & timelines.</span>
        </li>
      </ul>

      <!-- quick actions -->
      <div class="mt-10 flex flex-wrap items-center gap-4">
        <a href="https://wa.me/971551234567" target="_blank" rel="noopener"
           class="inline-flex items-center gap-2 rounded-full border border-black/10 px-4 py-2 text-sm hover:bg-black/[.03] transition">
          <i class="fab fa-whatsapp text-[#25D366]"></i> WhatsApp a Specialist
        </a>
        <span class="inline-flex items-center gap-2 rounded-full bg-[#18AFAB]/10 text-[#0B0E14] px-3 py-1.5 text-xs">
          <span class="h-2 w-2 rounded-full bg-[#18AFAB] animate-pulse"></span> Typical reply: ~4h
        </span>
      </div>
    </div>

    <!-- Right: form card -->
    <div class="relative reveal-right">
      <!-- soft teal aura -->
      <div class="pointer-events-none absolute -inset-6 rounded-[28px] bg-[radial-gradient(40%_30%_at_80%_10%,rgba(24,175,171,.10),transparent)]"></div>

      <!-- Posts to Django contact view -->
      <form id="contactForm" action="{% url 'contact' %}" method="post" novalidate
            class="relative grid gap-5 bg-white text-[#0B0E14] rounded-2xl shadow-[0_18px_40px_rgba(2,6,23,.08)] ring-1 ring-black/5 p-6 md:p-8">
        {% csrf_token %}

        <!-- Honeypot -->
        <label class="hidden" aria-hidden="true">
          <input type="text" name="company" tabindex="-1" autocomplete="off">
        </label>

        <!-- Service -->
        <label class="relative block">
          <span class="pointer-events-none absolute left-4 top-3 text-gray-400">
            <i class="fa-solid fa-layer-group"></i>
          </span>
          <select name="service" class="peer input-fx pr-9">
            <option value="">General Enquiry</option>
            <option>Landscape Design & Build</option>
            <option>Interior Design & Build</option>
            <option>Joinery</option>
            <option>Marble</option>
            <option>Facility Management</option>
          </select>
          <span class="float-label">Service</span>
        </label>

        <!-- Name -->
        <label class="relative block">
          <span class="pointer-events-none absolute left-4 top-3 text-gray-400">
            <i class="fa-regular fa-user"></i>
          </span>
          <input required name="name" type="text" class="peer input-fx" placeholder=" " />
          <span class="float-label">Full Name</span>
        </label>

        <!-- Email -->
        <label class="relative block">
          <span class="pointer-events-none absolute left-4 top-3 text-gray-400">
            <i class="fa-regular fa-envelope"></i>
          </span>
          <input required name="email" type="email" class="peer input-fx" placeholder=" " />
          <span class="float-label">Email Address</span>
        </label>

        <!-- Phone -->
        <label class="relative block">
          <span class="pointer-events-none absolute left-4 top-3 text-gray-400">
            <i class="fa-solid fa-phone"></i>
          </span>
          <input name="phone" type="text" class="peer input-fx" placeholder=" " />
          <span class="float-label">Phone Number</span>
        </label>

        <!-- Message -->
        <label class="relative block">
          <span class="pointer-events-none absolute left-4 top-3 text-gray-400">
            <i class="fa-regular fa-pen-to-square"></i>
          </span>
          <textarea required name="message" rows="4" class="peer input-fx resize-y" placeholder=" "></textarea>
          <span class="float-label">Tell us about your project</span>
        </label>

        <div class="flex flex-col md:flex-row items-center justify-between gap-4 pt-2">
          <p class="text-xs text-[#64748B]">
            By submitting, you agree to our <a href="#" class="underline decoration-[#18AFAB] underline-offset-2 hover:text-[#18AFAB]">privacy policy</a>.
          </p>

          <button id="submitBtn" type="submit"
                  class="group inline-flex w-full md:w-auto items-center justify-center gap-2 rounded-full bg-[#18AFAB] px-6 py-3 font-semibold text-[#0B0E14] shadow-md hover:shadow-lg transition will-change-transform">
            <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-black/5 overflow-hidden">
              <i class="fa-solid fa-paper-plane text-sm group-[.is-loading]:hidden"></i>
              <svg class="animate-spin h-4 w-4 group-[.is-loading]:inline-block hidden" viewBox="0 0 24 24" aria-hidden="true">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4A4 4 0 004 12z"></path>
              </svg>
            </span>
            <span class="group-[.is-loading]:opacity-60">Submit Inquiry</span>
          </button>
        </div>
      </form>

      <!-- Success toast -->
      <div id="contactToast" class="pointer-events-none fixed left-1/2 -translate-x-1/2 bottom-6 z-50 hidden">
        <div class="rounded-full bg-white text-[#0B0E14] shadow-xl ring-1 ring-black/5 px-4 py-2 flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full bg-[#18AFAB] animate-pulse"></span>
          <strong>Thanks!</strong> We’ve received your details—expect a reply within 24h.
        </div>
      </div>
    </div>
  </div>
</section>

<!-- WhatsApp FAB (kept) -->
<a href="https://wa.me/971551234567" target="_blank" rel="noopener"
   class="whatsapp-fab fixed bottom-6 right-6 bg-[#25D366] text-white px-5 py-3 rounded-full shadow-lg flex items-center gap-2 hover:brightness-110 transition">
  <i class="fab fa-whatsapp text-xl"></i><span>Let’s Discuss</span>
</a>

<!-- MAP (Light, matching contact) -->
<section id="map" class="relative overflow-hidden bg-[#F8FAFC] text-[#0B0E14]">
  <div class="pointer-events-none absolute inset-x-0 -top-40 h-80 bg-[radial-gradient(50%_50%_at_50%_0%,rgba(24,175,171,.12),transparent)]"></div>

  <div class="relative max-w-7xl mx-auto px-6 pt-10 pb-20">
    <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-6">
      <div>
        <p class="text-[11px] tracking-[.35em] uppercase text-[#18AFAB]">Find Us</p>
        <h3 class="mt-2 text-2xl md:text-3xl font-extrabold">Dubai, UAE</h3>
        <p class="mt-2 text-[#475569]">
          Hammer — Design & Build HQ<br>
          Dubai, United Arab Emirates
        </p>
      </div>
      <div class="flex items-center gap-3">
        <a href="https://www.google.com/maps/search/?api=1&query=Dubai%2C+UAE" target="_blank" rel="noopener"
           class="inline-flex items-center gap-2 rounded-full border border-black/10 px-4 py-2 text-sm hover:bg-black/[.03] transition">
          <i class="fa-solid fa-location-dot text-[#18AFAB]"></i> Open in Google Maps
        </a>
        <a href="tel:+971555555555"
           class="inline-flex items-center gap-2 rounded-full border border-black/10 px-4 py-2 text-sm hover:bg-black/[.03] transition">
          <i class="fa-solid fa-phone text-[#18AFAB]"></i> +971 55 555 5555
        </a>
      </div>
    </div>

    <div class="mt-6 relative rounded-2xl overflow-hidden shadow-[0_18px_40px_rgba(2,6,23,.08)] ring-1 ring-black/5 bg-white">
      <iframe
        title="Hammer – Dubai Map"
        width="100%" height="420" loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        style="border:0; display:block"
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14438.706907347632!2d55.2708!3d25.2048!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e5f434c2f2a0a65%3A0x9c33d6d0f4f0a0a8!2sDubai%2C%20UAE!5e0!3m2!1sen!2sAE!4v1680000000000">
      </iframe>
      <div class="pointer-events-none absolute left-4 top-4 rounded-full bg-white/85 text-[#0B0E14] text-xs px-3 py-1.5 backdrop-blur ring-1 ring-black/5">
        <span class="inline-flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-[#18AFAB]"></span> Dubai HQ
        </span>
      </div>
    </div>
  </div>
</section>

<style>
/* Float labels + input focus ring (light theme) */
.input-fx{
  width:100%;
  border-radius:.875rem;
  border:1px solid #E5E7EB;
  padding:.75rem 1rem .75rem 2.5rem;
  outline:none;
  transition: box-shadow .25s ease, border-color .25s ease, background-color .25s ease;
  background:#fff;
}
.input-fx:focus{
  border-color:#18AFAB;
  box-shadow:0 0 0 3px rgba(24,175,171,.18);
  background:#fff;
}
.float-label{
  position:absolute; left:2rem; top:-.5rem;
  background:#fff; padding:0 .4rem; border-radius:.35rem;
  font-size:11px; letter-spacing:.04em; color:#6B7280; transition: all .2s ease;
}
.peer::placeholder { color:transparent; }
.peer:placeholder-shown ~ .float-label{
  top:.75rem; left:2.5rem; background:transparent; font-size:.85rem;
}

/* Reveal animations */
.reveal-left, .reveal-right { opacity:0; transform: translateY(18px); }
.reveal-left.revealed, .reveal-right.revealed{
  opacity:1; transform:translateY(0); transition: all .8s cubic-bezier(.22,1,.36,1);
}
.reveal-right{ transform: translateY(18px) translateX(16px); }
.reveal-right.revealed{ transform:none; }

/* Button micro-movement */
#submitBtn:hover{ transform: translateY(-1px); }

/* WhatsApp FAB */
.whatsapp-fab{ box-shadow: 0 14px 30px -10px rgba(2,6,23,.20); }
</style>

<script>
/* Intersection reveal */
(function(){
  const nodes = document.querySelectorAll('#contact .reveal-left, #contact .reveal-right');
  if(!nodes.length) return;
  if(!('IntersectionObserver' in window)){
    nodes.forEach(n=>n.classList.add('revealed'));
    return;
  }
  const io = new IntersectionObserver((entries, obs)=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.style.transitionDelay = '80ms';
        e.target.classList.add('revealed');
        obs.unobserve(e.target);
      }
    });
  }, { threshold:.15 });
  nodes.forEach(n=>io.observe(n));
})();

/* AJAX submit to Django contact endpoint (progressive enhancement) */
(function(){
  const form  = document.getElementById('contactForm');
  const btn   = document.getElementById('submitBtn');
  const toast = document.getElementById('contactToast');
  if(!form) return;

  const getCSRF = () => {
    const el = form.querySelector('input[name=csrfmiddlewaretoken]');
    return el ? el.value : '';
  };

  form.addEventListener('submit', async function(e){
    e.preventDefault();

    btn.classList.add('is-loading');
    btn.setAttribute('disabled','disabled');

    try{
      const res = await fetch(form.action, {
        method: 'POST',
        headers: { 'X-CSRFToken': getCSRF() },
        body: new FormData(form),
      });

      if(!res.ok) throw new Error('Submit failed');

      form.reset();
      btn.classList.remove('is-loading');
      btn.removeAttribute('disabled');

      toast.classList.remove('hidden');
      toast.style.opacity = '0';
      toast.style.transform = 'translate(-50%, 10px)';
      requestAnimationFrame(()=>{
        toast.style.transition = 'all .4s ease';
        toast.style.opacity = '1';
        toast.style.transform = 'translate(-50%, 0)';
      });
      setTimeout(()=>{
        toast.style.opacity = '0';
        toast.style.transform = 'translate(-50%, 10px)';
        setTimeout(()=>toast.classList.add('hidden'), 350);
      }, 2800);

    } catch(err){
      btn.classList.remove('is-loading');
      btn.removeAttribute('disabled');
      form.submit();
    }
  });
})();
</script>
{% endblock %}
