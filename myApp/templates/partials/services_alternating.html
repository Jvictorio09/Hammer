{# templates/sections/services_section.html #}
{% load static %}

<section id="services" class="py-10 md:py-20">
  <div class="max-w-7xl mx-auto px-4 md:px-6">
    <div class="text-center mb-8 md:mb-14">
      <p class="text-[10px] tracking-[.3em] uppercase text-[#18AFAB]">What We Do</p>
      <h2 class="text-2xl md:text-4xl font-extrabold mt-1 md:mt-2">Design • Build • Maintain</h2>
      <p class="text-gray-600 max-w-xl md:max-w-2xl mx-auto mt-2 md:mt-3 text-sm md:text-base">
        End-to-end delivery across villas, interiors, landscapes, and facilities—handled by one accountable partner.
      </p>
    </div>

    {# Service Articles #}
    <div class="space-y-10 md:space-y-20">
      {% for s in services %}
        {% with is_even=forloop.counter|divisibleby:2 %}
        <article class="grid md:grid-cols-2 gap-5 md:gap-8 items-stretch {% if is_even %}fade-left{% else %}fade-up{% endif %}">
          
          {# IMAGE SIDE (alternates) #}
          {% if not is_even %}
            <div class="rounded-xl md:rounded-2xl overflow-hidden shadow-md md:shadow-lg relative group">
              {% if s.primary_image_url %}
                <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 md:group-hover:scale-105"
                     style="background-image:url('{{ s.primary_image_url }}')"></div>
              {% else %}
                <div class="absolute inset-0 bg-gradient-to-tr from-slate-900 via-slate-700 to-slate-500"></div>
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-tr from-black/50 via-black/15 to-transparent md:from-black/60 md:via-black/20"></div>
              <div class="block md:hidden" style="padding-top:56%"></div>
            </div>
          {% endif %}

          {# CONTENT SIDE #}
          <div class="rounded-xl md:rounded-2xl border border-black/5 p-5 md:p-8 lg:p-10 bg-white shadow-sm flex flex-col justify-center {% if is_even %}order-1 md:order-1{% endif %}">
            <p class="text-[10px] tracking-[.3em] uppercase text-[#18AFAB] mb-1.5 md:mb-2">
              {{ s.eyebrow|default:s.title }}
            </p>
            <h3 class="text-xl md:text-2xl font-bold leading-snug">
              {{ s.hero_headline|default:s.title }}
            </h3>
            {% if s.hero_subcopy %}
              <p class="text-gray-600 mt-2.5 md:mt-3 text-sm md:text-base">
                {{ s.hero_subcopy }}
              </p>
            {% endif %}

            <ul class="mt-4 md:mt-5 grid grid-cols-2 gap-2 text-sm">
              {% for icon,label in s.feature_icons %}
                <li class="flex items-center gap-2">
                  <i class="{{ icon }} text-[#18AFAB]"></i> {{ label }}
                </li>
              {% empty %}
                <li class="col-span-2 text-slate-500">Add features in Admin → Features</li>
              {% endfor %}
            </ul>

            <div class="mt-4 md:mt-6">
              <a href="{{ s.get_absolute_url }}" class="inline-flex items-center gap-2 font-semibold text-[#18AFAB] hover:opacity-90">
                View {{ s.title }} Projects <i class="fa-solid fa-arrow-right-long"></i>
              </a>
            </div>
          </div>

          {# IMAGE SIDE (when even, image on right) #}
          {% if is_even %}
            <div class="rounded-xl md:rounded-2xl overflow-hidden shadow-md md:shadow-lg relative group order-2 md:order-2">
              {% if s.primary_image_url %}
                <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 md:group-hover:scale-105"
                     style="background-image:url('{{ s.primary_image_url }}')"></div>
              {% else %}
                <div class="absolute inset-0 bg-gradient-to-tl from-slate-900 via-slate-700 to-slate-500"></div>
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-tl from-black/50 via-black/15 to-transparent md:from-black/60 md:via-black/20"></div>
              <div class="block md:hidden" style="padding-top:56%"></div>
            </div>
          {% endif %}
        </article>
        {% endwith %}
      {% empty %}
        <p class="text-slate-500">No services yet—add some in Admin.</p>
      {% endfor %}
    </div>
  </div>
</section>

{# Scroll Animations #}
<style>
.fade-up, .fade-left, .fade-right {
  opacity: 0;
  transform: translateY(24px);
  transition: all .7s cubic-bezier(0.22, 1, 0.36, 1);
}
.fade-left { transform: translateX(-28px); }
.fade-right{ transform: translateX(28px); }
@media (min-width: 768px){
  .fade-up, .fade-left, .fade-right { transform: translateY(30px); }
  .fade-left { transform: translateX(-40px); }
  .fade-right{ transform: translateX(40px); }
}
.is-visible { opacity: 1; transform: translate(0,0); }
</style>

<script>
(function(){
  const items = document.querySelectorAll('.fade-up, .fade-left, .fade-right');
  if(!('IntersectionObserver' in window)){ items.forEach(el=>el.classList.add('is-visible')); return; }
  const io = new IntersectionObserver((entries, obs)=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        entry.target.classList.add('is-visible');
        obs.unobserve(entry.target);
      }
    });
  }, { threshold: 0.15 });
  items.forEach(el=>io.observe(el));
})();
</script>
